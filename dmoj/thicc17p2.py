n, a, b, m = map(int, input().split())
s1, s2 = 0, 0
for i in range(n):
  s1 = (s1 + a) % 1000000007
  s2 = (s2 + (a * a) % 1000000007) % 1000000007
  a = ((a * b) % m) % 1000000007
print (((((s1 * s1) % 1000000007) % 1000000007) - (s2 % 1000000007)) % 1000000007)
